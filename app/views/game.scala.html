@(game: models.Game)

@scores(platform: Platform, difficulty: Difficulty, mode: Mode) = {
    @if(!game.scoresByPlayers(platform, difficulty, mode).isEmpty) {
        <h4>
            @if(platform != null) {
                <span class="label label-success">@platform.name</span>
            }
            @if(difficulty != null) {
                <span class="label label-warning">@difficulty.name</span>
            }
            @if(mode != null) {
                <span class="label label-default">@mode.name</span>
            }
        </h4>
        <table class="table table-condensed table-hover table-bordered">
            <thead>
                <th style="width: 50px; text-align: center;">#</th>
                <th style="text-align: center;" >Shmuper</th>
                <th style="text-align: center;" >Score</th>
                <th style="text-align: center;" >Stage</th>
                <th style="text-align: center; width: 50px;">Commentaire</th>
            </thead>
        @for(score <- game.scoresByPlayers(platform, difficulty, mode)) {
            <tr>
                <td style="text-align: right;">@score.formattedRank</td>
                <td><a href="@routes.Player.index(score.player)">@score.player.name</a></td>
                <td style="text-align: right;">@score.formattedValue</td>
                <td>@score.stage.name</td>
                <td style="text-align: center;">
                    @if(score.comment) {
                        <button id="comment_@score.id" type="button" class="btn btn-xs btn-default" data-container="body" data-trigger="hover" data-toggle="popover" data-placement="left" data-content="@score.comment" data-original-title="" title="">
                            afficher
                        </button>
                        <script>
                            $('#comment_@score.id').popover('hide');
                        </script>
                    }
                </td>
            </tr>
        }
        </table>
    }
}

@main() {

   <h2 class="title">
       @game.title
       <a href="@game.thread" class="btn btn-default btn-lg btn-xs">
           <span class="glyphicon glyphicon-share-alt"></span> forum
       </a>
   </h2>

    @if(game.platforms.isEmpty) {
        @if(game.modes.isEmpty) {
            @if(game.difficulties.isEmpty) {
                @scores(null, null, null)
            } else {
                @for(difficulty <- game.difficulties) {
                    @scores(null, difficulty, null)
                }
            }
        } else {
            @for(mode <- game.modes) {
                @if(game.difficulties.isEmpty) {
                    @scores(null, null, mode)
                } else {
                    @for(difficulty <- game.difficulties) {
                        @scores(null, difficulty, mode)
                    }
                }
            }
        }
    } else {
        @for(platform <- game.platforms) {
            @if(game.modes.isEmpty) {
                @if(game.difficulties.isEmpty) {
                    @scores(null, null, null)
                } else {
                    @for(difficulty <- game.difficulties) {
                        @scores(platform, difficulty, null)
                    }
                }
            } else {
                @for(mode <- game.modes) {
                    @if(game.difficulties.isEmpty) {
                        @scores(platform, null, mode)
                    } else {
                        @for(difficulty <- game.difficulties) {
                            @scores(platform, difficulty, mode)
                        }
                    }
                }
            }
        }
    }

}
